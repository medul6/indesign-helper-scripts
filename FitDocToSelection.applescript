-- FitDocToSelection for InDesign-- version 1.0a-- created by medul6, Michael Heck, 2013-- open sourced on May 15th, 2013 on Github > check the LICENSE.txt and README.md in the repository for detailed information-- https://github.com/medul6/indesign-helper-scripts-- •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••-- global variables--global activeDocument--global openDocumentsglobal stopBool--test variables!!!-- •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••set myObjectList to {}tell application id "com.adobe.InDesign"		set myPageItemTypes to {rectangle, oval, polygon, text frame, graphic line, group}	if (count documents) > 0 then		set mySelection to selection		if (count mySelection) > 0 then			repeat with myCounter from 1 to (count mySelection)				if (class of item myCounter of mySelection) is in myPageItemTypes then					copy item myCounter of mySelection to end of myObjectList				end if			end repeat			if (count myObjectList) > 0 then				--my myDisplayDialog(myObjectList)			end if		else			display dialog "Please select a page item and try again."		end if	else		display dialog "Please open a document, select a page item, and try again."	end if			set myOldRulerOrigin to ruler origin of view preferences of active document	set ruler origin of view preferences of active document to spread origin		repeat with myCounter from 1 to (count myObjectList)		set myPageItem to item myCounter of myObjectList		--Get the bounds of the item.		set myBounds to geometric bounds of myPageItem		if myCounter = 1 then			set myY1 to (item 1 of myBounds)			set myX1 to (item 2 of myBounds)			set myY2 to (item 3 of myBounds)			set myX2 to (item 4 of myBounds)		else			if item 1 of myBounds < myY1 then				set myY1 to (item 1 of myBounds)			end if			if item 2 of myBounds < myX1 then				set myX1 to (item 2 of myBounds)			end if			if item 3 of myBounds > myY2 then				set myY2 to (item 3 of myBounds)			end if			if item 4 of myBounds > myX2 then				set myX2 to (item 4 of myBounds)			end if		end if	end repeat		set ruler origin of view preferences of active document to myOldRulerOrigin						--tell application id "com.adobe.InDesign"	tell document preferences of active document		set page height to myY2 - myY1		set page width to myX2 - myX1		set document bleed top offset to "3"		set document bleed uniform size to true	end tell	--end tell						--tell application id "com.adobe.InDesign"	--set mySelection to every item of selection of active document		set myPage to parent page of item 1 of selection of active document			if (count mySelection) > 1 then		tell myPage			set myGroup to make group with properties {group items:mySelection}		end tell	else		set myGroup to mySelection	end if					select nothing	select myGroup	move myGroup to [0, 0]			if (count mySelection) > 1 then		tell myGroup to ungroup	end if			--end tell						end tell-- •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••on revertActiveDoc()	tell application id "com.adobe.InDesign"				tell script preferences			set properties to {user interaction level:never interact}		end tell				revert active document				tell script preferences			set properties to {user interaction level:interact with all}		end tell	end tellend revertActiveDoc